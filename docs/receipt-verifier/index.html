<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.64">
<link rel="search" type="application/opensearchdescription+xml" title="Web Monetization" href="/opensearch.xml">
<script src="https://buttons.github.io/buttons.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
<script src="/js/custom.js"></script><title data-react-helmet="true">Receipt Verifier Service | Web Monetization</title><meta data-react-helmet="true" name="docsearch:version" content="current,latest"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Receipt Verifier Service | Web Monetization"><meta data-react-helmet="true" name="description" content="This page explains how to set up a receipt verifier service."><meta data-react-helmet="true" property="og:description" content="This page explains how to set up a receipt verifier service."><meta data-react-helmet="true" property="og:url" content="https://webmonetization.org/docs/receipt-verifier"><link data-react-helmet="true" rel="shortcut icon" href="/img/fav-webmonetization.png"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="true"><link data-react-helmet="true" rel="canonical" href="https://webmonetization.org/docs/receipt-verifier"><link rel="stylesheet" href="/styles.6b39dcea.css">
<link rel="preload" href="/styles.25ffec63.js" as="script">
<link rel="preload" href="/runtime~main.92697bc5.js" as="script">
<link rel="preload" href="/main.66ec94cb.js" as="script">
<link rel="preload" href="/1.62291f3e.js" as="script">
<link rel="preload" href="/2.cd0906a7.js" as="script">
<link rel="preload" href="/32.af2a642c.js" as="script">
<link rel="preload" href="/35.ac07a4ea.js" as="script">
<link rel="preload" href="/935f2afb.ae95a9a7.js" as="script">
<link rel="preload" href="/17896441.7251c7ca.js" as="script">
<link rel="preload" href="/3e831a1a.5c7d3274.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/wm-icon.svg" alt="Web Monetization logo"><strong class="navbar__title">Web Monetization</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" doc="getting-started" href="/docs">Docs</a><a href="https://webmonetization.org/specification.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Specification</a><a href="https://discourse.wicg.io/t/proposal-web-monetization-a-new-revenue-model-for-the-web/3785" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">WICG Forum</a><a href="https://github.com/WICG/webmonetization" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><a target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"></a></div><div class="navbar__items navbar__items--right"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">⌘</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/wm-icon.svg" alt="Web Monetization logo"><strong class="navbar__title">Web Monetization</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" doc="getting-started" href="/docs">Docs</a></li><li class="menu__list-item"><a href="https://webmonetization.org/specification.html" target="_blank" rel="noopener noreferrer" class="menu__link">Specification</a></li><li class="menu__list-item"><a href="https://discourse.wicg.io/t/proposal-web-monetization-a-new-revenue-model-for-the-web/3785" target="_blank" rel="noopener noreferrer" class="menu__link">WICG Forum</a></li><li class="menu__list-item"><a href="https://github.com/WICG/webmonetization" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" class="menu__link"></a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Overview</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started">Quick start guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api">JavaScript API</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Examples</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/exclusive-content">Exclusive content</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/remove-ads">Remove ads</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/counter">Micropayment counter</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/probabilistic-rev-sharing">Probabilistic revenue sharing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/start-stop">Start/stop monetization</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/receipt-verifier">Receipt verifier service</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Explainer</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/explainer">Web Monetization</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/receiving">Receiving payments</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/sending">Sending payments</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Wallets</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ilp-wallets">Digital wallets and payment pointers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/gatehub">GateHub</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/stronghold">Stronghold</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/uphold">Uphold</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/xrptipbot">XRP Tipbot</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">More</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/specification">Specification</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/glossary">Glossary</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/resources">External resources</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Receipt Verifier Service</h1></header><div class="markdown"><p>This page explains how to set up a receipt verifier service.</p><p>As more creators adopt Web Monetization to serve premium and/or ad-free content, there’s a greater need for reliable payment verification. Web Monetization browser events, like <code>monetizationstart</code>, are helpful indicators of payment, but can be spoofed by savvy users to access exclusive content without paying.</p><p><a href="https://interledger.org/rfcs/0039-stream-receipts/" target="_blank" rel="noopener noreferrer">Interledger STREAM receipts</a> provide payment recipients (such as web monetized site owners) with verifiable proofs of payment. As a payment recipient, you can verify STREAM receipts yourself by setting up your own receipt verifier service or by using a third-party service, like <a href="#use-our-publicly-available-receipt-verifier">the one we provide</a>. You don&#x27;t need to run your own Interledger connector or SPSP server to verify STREAM receipts.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="before-you-begin"></a>Before you begin<a aria-hidden="true" tabindex="-1" class="hash-link" href="#before-you-begin" title="Direct link to heading">#</a></h2><p>Your Web Monetization receiver (the digital entity receiving payments) must be set up to generate Interledger STREAM receipts. No action is required on your part. GateHub and Uphold already support receipts.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="receipt-verifier-service-overview"></a>Receipt verifier service overview<a aria-hidden="true" tabindex="-1" class="hash-link" href="#receipt-verifier-service-overview" title="Direct link to heading">#</a></h2><p>The receipt verifier service acts as a proxy between the Web Monetization sender and receiver.</p><p>Before a payment is made, the WM sender sends a query to the WM receiver. The query passes through the receipt verifier service, which adds a receipt secret and receipt nonce.</p><p>When the WM receiver receives money from the payment, it generates a receipt (which includes a signature generated using the receipt secret) and sends the receipt to the WM sender.</p><p>The site takes the receipt from the Web Monetization events, then submits the receipt to its backend. The backend then submits the receipt to the receipt verifier service so the receipt verifier service can confirm the payment (as only it and the WM receiver know the receipt secret). The receipt verifier service must verify the receipt before accepting the amount as paid.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="use-our-publicly-available-receipt-verifier"></a>Use our publicly available receipt verifier<a aria-hidden="true" tabindex="-1" class="hash-link" href="#use-our-publicly-available-receipt-verifier" title="Direct link to heading">#</a></h2><p>If you don&#x27;t want to set up your own receipt verifier service, you can use ours!</p><p>Review the following sections below and use <code>https://webmonetization.org/api/receipts</code> as the receipt verifier service&#x27;s URL.</p><ul><li><a href="#update-your-web-monetization-meta-tag">Update your Web Monetization meta tag</a></li><li><a href="#set-up-a-monetizationprogress-event-listener">Set up a monetizationprogress event listener</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="install-the-receipt-verifier-service-package"></a>Install the receipt verifier service package<a aria-hidden="true" tabindex="-1" class="hash-link" href="#install-the-receipt-verifier-service-package" title="Direct link to heading">#</a></h2><p>You can get the <a href="https://github.com/coilhq/receipt-verifier" target="_blank" rel="noopener noreferrer">receipt verifier service package</a> or run the receipt verifier service as a <a href="https://github.com/coilhq/receipt-verifier/tree/main/config/base" target="_blank" rel="noopener noreferrer">Kubernetes service</a>.</p><p><strong>Example</strong></p><p>This example shows Coil&#x27;s implementation of the receipt verifier service package, which requires Redis. You can write a different implementation that doesn&#x27;t rely on Redis.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">npm install</span></div><div class="token-line" style="color:#393A34"><span class="token plain">npm run-script build</span></div><div class="token-line" style="color:#393A34"><span class="token plain">sudo docker run -p 6379:6379 -d redis</span></div><div class="token-line" style="color:#393A34"><span class="token plain">npm start</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/coilhq/receipt-verifier.git</span></div><div class="token-line" style="color:#393A34"><span class="token plain">cd receipt-verifier</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="update-your-web-monetization-meta-tag"></a>Update your Web Monetization meta tag<a aria-hidden="true" tabindex="-1" class="hash-link" href="#update-your-web-monetization-meta-tag" title="Direct link to heading">#</a></h2><p>Typically, a Web Monetization meta tag looks something like this:</p><p><code>&lt;meta name=“monetization&quot; content=&quot;$wallet.example/alice&quot;&gt;</code></p><p>For queries from the WM sender to be proxied by the receipt verifier service to your payment pointer:</p><ol><li>URI-encode your payment pointer. See <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent" target="_blank" rel="noopener noreferrer">encodeURIComponent()</a> on MDN Web Docs if you need help.</li><li>Add your pointer to the path of the receipt verifier service&#x27;s URL.</li><li>Update your meta tag&#x27;s <code>content</code> to be this new value.</li></ol><p>For example, if your payment pointer is <code>$wallet.example/alice</code> and your receipt verifier service’s URL is <code>https://receipt-verifier.example</code>, then you’ll set your meta tag’s <code>content</code> to either of the following:</p><ul><li><code>https://receipt-verifier.example/%24wallet.example%2Falice</code></li><li><code>$receipt-verifier.example/%24wallet.example%2Falice</code></li></ul><p>If you&#x27;re using our publicly available receipt verifier service, then you&#x27;ll set your meta tag&#x27;s <code>content</code> to either of the following:</p><ul><li><code>https://webmonetization.org/api/receipts/%24wallet.example%2Falice</code></li><li><code>$webmonetization.org/api/receipts/%24wallet.example%2Falice</code></li></ul><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>You can create your meta tag with the <a href="/meta-tag">Meta Tag Generator</a> if using the publicly available receipt verifier service.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="web-monetization-revshare-generator"></a>Web Monetization revshare generator<a aria-hidden="true" tabindex="-1" class="hash-link" href="#web-monetization-revshare-generator" title="Direct link to heading">#</a></h2><p>If you used the <a href="https://webmonetization.org/prob-revshare" target="_blank" rel="noopener noreferrer">Web Monetization revshare generator</a> to create a meta tag for <a href="/docs/probabilistic-rev-sharing/">probabilistic revenue sharing</a>, follow the same instructions as above: URI-encode your revshare payment pointer and put it in the path of the receipt verifier service’s URL.</p><p>For example, if your meta tag looks like this:</p><p><code>&lt;meta name=&quot;monetization&quot; content=&quot;$webmonetization.org/api/revshare/pay/W1siJHdhbGxldC5leGFtcGxlL2FsaWNlIiwxMCwiQWxpY2UiXSxbIiR3YWxsZXQuZXhhbXBsZS9ib2IiLDEwLCJCb2IiXV0&quot;&gt;</code></p><p>And your receipt verifier service’s URL is <code>https://receipt-verifier.example</code>, then you’ll set your meta tag’s <code>content</code> to either of the following:</p><ul><li><code>https://receipt-verifier.example/%24webmonetization.org%2Fapi%2Frevshare%2Fpay%2FW1siJHdhbGxldC5leGFtcGxlL2FsaWNlIiwxMCwiQWxpY2UiXSxbIiR3YWxsZXQuZXhhbXBsZS9ib2IiLDEwLCJCb2IiXV0</code></li><li><code>$receipt-verifier.example/ %24webmonetization.org%2Fapi%2Frevshare%2Fpay%2FW1siJHdhbGxldC5leGFtcGxlL2FsaWNlIiwxMCwiQWxpY2UiXSxbIiR3YWxsZXQuZXhhbXBsZS9ib2IiLDEwLCJCb2IiXV0</code></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="set-up-a-monetizationprogress-event-listener"></a>Set up a monetizationprogress event listener<a aria-hidden="true" tabindex="-1" class="hash-link" href="#set-up-a-monetizationprogress-event-listener" title="Direct link to heading">#</a></h2><p>When a WM sender receives a receipt, the sender notifies the user agent of the successful payment by submitting a <code>monetizationprogress</code> event containing a receipt.</p><p>Add the following client-side code to your website to listen for a <code>monetizationprogress</code> event containing a <code>receipt</code>. When a receipt exists, your website will verify the receipt in the event listener to confirm the payment.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-html codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">head</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- This should be set to .... --&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">meta</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">monetization</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">content</span><span class="token tag attr-value punctuation" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">https://receipt-verifier.example/%24wallet.example%2Falice</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript keyword" style="color:#00009f">if</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript dom variable" style="color:#36acaa">document</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">monetization</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#393A34"><span class="token script language-javascript">        </span><span class="token script language-javascript dom variable" style="color:#36acaa">document</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">monetization</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">addEventListener</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&#x27;monetizationprogress&#x27;</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> </span><span class="token script language-javascript parameter">event</span><span class="token script language-javascript"> </span><span class="token script language-javascript arrow operator" style="color:#393A34">=&gt;</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#393A34"><span class="token script language-javascript">            </span><span class="token script language-javascript comment" style="color:#999988;font-style:italic">// A payment has been received.</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token script language-javascript">            </span><span class="token script language-javascript comment" style="color:#999988;font-style:italic">// Connect to your site’s backend to validate the payment. This does NOT connect directly to the receipt verifier.</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#393A34"><span class="token script language-javascript">            </span><span class="token script language-javascript keyword" style="color:#00009f">const</span><span class="token script language-javascript"> res </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript keyword" style="color:#00009f">await</span><span class="token script language-javascript"> </span><span class="token script language-javascript function" style="color:#d73a49">fetch</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&#x27;/verifyReceipt&#x27;</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#393A34"><span class="token script language-javascript">              method</span><span class="token script language-javascript punctuation" style="color:#393A34">:</span><span class="token script language-javascript"> </span><span class="token script language-javascript string" style="color:#e3116c">&#x27;POST&#x27;</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#393A34"><span class="token script language-javascript">              headers</span><span class="token script language-javascript punctuation" style="color:#393A34">:</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#393A34"><span class="token script language-javascript">                </span><span class="token script language-javascript string" style="color:#e3116c">&#x27;Content-Type&#x27;</span><span class="token script language-javascript punctuation" style="color:#393A34">:</span><span class="token script language-javascript"> </span><span class="token script language-javascript string" style="color:#e3116c">&#x27;application/json&#x27;</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#393A34"><span class="token script language-javascript">              </span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#393A34"><span class="token script language-javascript">              body</span><span class="token script language-javascript punctuation" style="color:#393A34">:</span><span class="token script language-javascript"> </span><span class="token script language-javascript known-class-name class-name">JSON</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">stringify</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#393A34"><span class="token script language-javascript">                receipt</span><span class="token script language-javascript punctuation" style="color:#393A34">:</span><span class="token script language-javascript"> event</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">detail</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">receipt</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#393A34"><span class="token script language-javascript">              </span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#393A34"><span class="token script language-javascript">            </span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#393A34"><span class="token script language-javascript">        </span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#393A34"><span class="token script language-javascript">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">head</span><span class="token tag punctuation" style="color:#393A34">&gt;</span></div></div></div></div></div><p>Your backend can send the receipt to the receipt verifier service’s <code>/verify</code> endpoint.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>If you&#x27;re using our publicly available receipt verifier service, the verify endpoint is <code>https://webmonetization.org/api/receipts/verify</code>.</p></div></div><p>Here’s an example for an Express.js server:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-javascript codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/verifyReceipt&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">req</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> res</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> resp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fetch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;https://receipt-verifier.example/verify&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    method</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;POST&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    body</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">body</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">receipt</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> amount </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> resp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">json</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Received &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> amount</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// backend logic for new paid amount</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><p>The receipt verifier service can confirm the payment, as only the receipt verifier service and the WM receiver know the receipt secret. The receipt verifier service must verify the receipt before accepting the receipt amount as paid. When accepted as paid, the site backend can serve exclusive content or any other perks you’ve set up.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/WICG/webmonetization/tree/master/docs/receipt-verifier.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/start-stop"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Start/Stop Monetization</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/explainer"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Web Monetization Explainer »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#before-you-begin" class="table-of-contents__link">Before you begin</a></li><li><a href="#receipt-verifier-service-overview" class="table-of-contents__link">Receipt verifier service overview</a></li><li><a href="#use-our-publicly-available-receipt-verifier" class="table-of-contents__link">Use our publicly available receipt verifier</a></li><li><a href="#install-the-receipt-verifier-service-package" class="table-of-contents__link">Install the receipt verifier service package</a></li><li><a href="#update-your-web-monetization-meta-tag" class="table-of-contents__link">Update your Web Monetization meta tag</a></li><li><a href="#web-monetization-revshare-generator" class="table-of-contents__link">Web Monetization revshare generator</a></li><li><a href="#set-up-a-monetizationprogress-event-listener" class="table-of-contents__link">Set up a monetizationprogress event listener</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">WebMonetization.org</h4></div><div class="col footer__col"><h4 class="footer__title">Navigation</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/">Home</a></li><li class="footer__item"><a class="footer__link-item" href="/meta-tag">Meta Tag Generator</a></li><li class="footer__item"><a class="footer__link-item" href="/prob-revshare">Revshare Generator</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/WICG/webmonetization" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github</a></li><li class="footer__item"><a href="https://forum.interledger.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">ILP Forum</a></li><li class="footer__item"><a href="https://discourse.wicg.io/t/proposal-web-monetization-a-new-revenue-model-for-the-web/3785" target="_blank" rel="noopener noreferrer" class="footer__link-item">Web Platform Incubator Community Group</a></li><li class="footer__item"><a href="https://interledger.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Interledger</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Resources</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started">Docs</a></li><li class="footer__item"><a href="https://webmonetization.org/specification.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Specification</a></li><li class="footer__item"><a href="https://paymentpointers.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Payment Pointers</a></li></ul></div></div><div class="text--center"><div></div></div></div></footer></div>
<script src="/styles.25ffec63.js"></script>
<script src="/runtime~main.92697bc5.js"></script>
<script src="/main.66ec94cb.js"></script>
<script src="/1.62291f3e.js"></script>
<script src="/2.cd0906a7.js"></script>
<script src="/32.af2a642c.js"></script>
<script src="/35.ac07a4ea.js"></script>
<script src="/935f2afb.ae95a9a7.js"></script>
<script src="/17896441.7251c7ca.js"></script>
<script src="/3e831a1a.5c7d3274.js"></script>
</body>
</html>